<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Zermelo navigation problem · Control loss</title><meta name="title" content="Zermelo navigation problem · Control loss"/><meta property="og:title" content="Zermelo navigation problem · Control loss"/><meta property="twitter:title" content="Zermelo navigation problem · Control loss"/><meta name="description" content="Documentation for Control loss."/><meta property="og:description" content="Documentation for Control loss."/><meta property="twitter:description" content="Documentation for Control loss."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="https://control-toolbox.org/assets/css/documentation.css" rel="stylesheet" type="text/css"/><script src="https://control-toolbox.org/assets/js/documentation.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Control loss</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><a class="tocitem" href="statement.html">Statement of the problem</a></li><li><a class="tocitem" href="numerical.html">Numerical approach</a></li><li class="is-active"><a class="tocitem" href="zermelo.html">Zermelo navigation problem</a><ul class="internal"><li><a class="tocitem" href="#Reformulation-for-the-direct-method"><span>Reformulation for the direct method</span></a></li><li class="toplevel"><a class="tocitem" href="#Zermelo-problem,-example-2"><span>Zermelo problem, example 2</span></a></li><li><a class="tocitem" href="#Reformulation-for-the-direct-method-2"><span>Reformulation for the direct method</span></a></li></ul></li><li><a class="tocitem" href="ho.html">Harmonic oscillator problem</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="zermelo.html">Zermelo navigation problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="zermelo.html">Zermelo navigation problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/control-toolbox/control-loss" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/control-toolbox/control-loss/blob/main/docs/src/zermelo.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Zermelo-problem,-example-1"><a class="docs-heading-anchor" href="#Zermelo-problem,-example-1">Zermelo problem, example 1</a><a id="Zermelo-problem,-example-1-1"></a><a class="docs-heading-anchor-permalink" href="#Zermelo-problem,-example-1" title="Permalink"></a></h1><p class="math-container">\[    \left\{
    \begin{array}{l}
        \displaystyle \min - x_1(8), \\[0.5em]
        \dot{x}_1(t) = x_2(t) + \cos(u(t)), \; \text{for a.e. } t\in [0,8],\\[0.5em]
        \dot{x}_2(t) = \sin(u(t)),  \; \text{for a.e. } t\in [0,8], \\[0.5em]
        u(t) \in [-\frac{\pi}{2}, \frac{\pi}{2}], \; \text{for a.e. } t\in [0,8], \\[0.5em]
        x(0) = 0_{\mathbb{R}^2}, \quad x_2(8) = 4,\\[0.5em]
        \{x \in \mathbb{R}^2 \mid 0.5 &lt; x_2 &lt; 3.5 \} \text{ is a loss control region.}
    \end{array}
    \right.\]</p><h2 id="Reformulation-for-the-direct-method"><a class="docs-heading-anchor" href="#Reformulation-for-the-direct-method">Reformulation for the direct method</a><a id="Reformulation-for-the-direct-method-1"></a><a class="docs-heading-anchor-permalink" href="#Reformulation-for-the-direct-method" title="Permalink"></a></h2><p class="math-container">\[    \left\{
    \begin{array}{l}
        \displaystyle \min - x_1(8) + \epsilon\int_0^8 v^2(t)dt + \int_0^1 f_{NC}(x(t))u^2(t)dt, \\[0.5em]
        \dot{x}_1(t) = f_{C}(x(t))(x_2(t) + \cos(u(t))) + f_{NC}(x_2(t) + \cos(\lambda(t))), \; \text{for a.e. } t\in [0,8],\\[0.5em]
        \dot{x}_2(t) = f_{C}(x(t))\sin(u(t)) + f_{NC}(x(t))\sin(\lambda(t)),  \; \text{for a.e. } t\in [0,8], \\[0.5em]
        \dot{\lambda}(t) = f_{C}(x(t))v^2(t),  \; \text{for a.e. } t\in [0,8], \\[0.5em]

        u(t) \in [-\frac{\pi}{2}, \frac{\pi}{2}], \; \text{for a.e. } t\in [0,8], \\[0.5em]
        x(0) = 0_{\mathbb{R}^2}, \quad x_2(8) = 4,\\[0.5em]
        \{x \in \mathbb{R}^2 \mid 0.5 &lt; x_2 &lt; 3.5 \} \text{ is a loss control region.}
    \end{array}
    \right.\]</p><pre><code class="language-julia hljs">using JuMP
using Ipopt
using Plots
using Plots.PlotMeasures
using LaTeXStrings
using OptimalControl
using NLPModelsIpopt
include(&quot;smooth.jl&quot;);</code></pre><pre><code class="language-julia hljs">I = [(0.5, 3.5)]
ε1 = 0.01
fNC(x) = fNC_bounded(x,I,ε1)
plot(fNC,0., 5, label=&quot;fNC&quot;)</code></pre><img src="zermelo-5845a6f7.svg" alt="Example block output"/><pre><code class="language-julia hljs">@def ocp begin

    ε   = 1e-3
    tf  = 8


    t ∈ [ 0., tf ],                  time

    q = [ x1, x2, λ, xu, xv ] ∈ R^5, state

    ω = [u, v] ∈ R^2,                control

    #initial conditions
    x1(0) == 0
    x2(0) == 0
    xu(0) == 0
    xv(0) == 0

    #final condition
    x2(tf) == 4

    #control constraint
    -π/2  ≤  u(t)  ≤ π/2

    #state constraints
    -π/2  ≤  λ(t)  ≤ π/2

    #hybrid control system
     q̇(t) == [fNC(x2(t))*(x2(t) + cos(λ(t))) + (1-fNC(x2(t)))*(x2(t) + cos(u(t))),
             fNC(x2(t))*sin(λ(t)) +(1-fNC(x2(t)))*sin(u(t)),
             (1-fNC(x2(t)))*v(t),
             (v(t))^2,
             fNC(x2(t))*(u(t))^2]

    #cost function
    -x1(tf) + ε*xv(tf) + xu(tf) → min
end;</code></pre><pre><code class="language-julia hljs">N = 500
sol = solve(ocp; grid_size=N);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">This is Ipopt version 3.14.16, running with linear solver MUMPS 5.7.3.

Number of nonzeros in equality constraint Jacobian...:    15005
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     3507

Total number of variables............................:     3507
                     variables with only lower bounds:        0
                variables with lower and upper bounds:     1002
                     variables with only upper bounds:        0
Total number of equality constraints.................:     2505
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  1.0000000e-04 3.90e+00 9.70e-03   0.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -2.4262403e+01 7.01e-03 1.01e+01  -5.8 2.41e+01    -  7.79e-01 1.00e+00f  1
   2 -2.3727053e+01 1.91e-02 2.48e+01  -1.1 1.11e+00    -  6.21e-01 1.00e+00h  1
   3 -2.3691744e+01 1.62e-01 2.02e+01  -1.1 5.85e+00  -2.0 9.96e-01 5.36e-01h  1
   4 -2.3562041e+01 2.60e-02 2.60e+00  -1.6 1.29e+00  -0.7 9.77e-01 1.00e+00h  1
   5 -2.3554439e+01 8.09e-04 1.37e-01  -3.2 2.27e-01  -0.2 1.00e+00 1.00e+00h  1
   6 -2.3642759e+01 9.53e-04 4.39e-02  -3.5 1.76e-01  -0.7 9.93e-01 1.00e+00f  1
   7 -2.3903342e+01 4.86e-03 1.05e-01  -4.5 5.06e-01  -1.2 1.00e+00 1.00e+00f  1
   8 -2.4541814e+01 1.97e-02 4.01e-01  -4.3 1.08e+00  -1.7 1.00e+00 1.00e+00f  1
   9 -2.4646948e+01 5.49e-03 1.99e-01  -5.1 3.18e-01  -1.3 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -2.5076707e+01 1.70e-02 2.40e-01  -5.5 7.20e-01  -1.7 1.00e+00 1.00e+00f  1
  11 -2.5196441e+01 1.60e-02 2.25e-01  -4.5 2.00e+01  -2.2 1.00e+00 5.99e-02f  1
  12 -2.5528604e+01 1.81e-02 4.22e-01  -4.6 1.60e+00  -1.8 1.00e+00 7.48e-01h  1
  13 -2.5668323e+01 5.55e-03 2.05e-01  -4.0 2.48e-01  -1.4 1.00e+00 1.00e+00h  1
  14 -2.6096250e+01 1.57e-02 2.45e-01  -3.3 5.77e-01  -1.8 8.87e-01 1.00e+00f  1
  15 -2.6340848e+01 1.59e-02 2.00e-01  -2.8 6.28e+00  -2.3 1.00e+00 1.84e-01f  1
  16 -2.6725545e+01 1.71e-02 4.04e-01  -3.0 1.33e+00  -1.9 9.80e-01 8.74e-01h  1
  17 -2.6879925e+01 6.44e-03 1.54e-01  -3.8 2.65e-01  -1.5 9.99e-01 1.00e+00h  1
  18 -2.7358684e+01 2.10e-02 3.32e-01  -4.1 9.14e-01  -1.9 1.00e+00 1.00e+00f  1
  19 -2.7457037e+01 2.00e-02 3.15e-01  -3.0 2.22e+01  -2.4 1.00e+00 5.08e-02h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 -2.7812857e+01 1.58e-02 2.38e-01  -3.2 1.57e+00  -2.0 9.90e-01 7.21e-01h  1
  21 -2.7989376e+01 7.70e-03 1.57e-01  -3.9 3.39e-01  -1.6 1.00e+00 1.00e+00h  1
  22 -2.8498363e+01 2.52e-02 4.26e-01  -4.1 1.18e+00  -2.0 1.00e+00 9.34e-01f  1
  23 -2.8688729e+01 8.29e-03 2.08e-01  -4.6 3.55e-01  -1.6 1.00e+00 1.00e+00h  1
  24 -2.8988990e+01 1.50e-02 2.20e-01  -4.1 2.13e+00  -2.1 1.00e+00 5.08e-01f  1
  25 -2.9197037e+01 8.06e-03 2.84e-01  -4.8 3.35e-01  -1.7 1.00e+00 1.00e+00h  1
  26 -2.9574275e+01 1.94e-02 1.49e-01  -4.3 1.74e+00  -2.1 1.00e+00 6.17e-01f  1
  27 -2.9795310e+01 1.17e-02 1.97e-01  -4.9 4.59e-01  -1.7 1.00e+00 1.00e+00h  1
  28 -3.0010830e+01 1.71e-02 3.41e-01  -4.3 3.33e+00  -2.2 1.00e+00 3.18e-01h  1
  29 -3.0217047e+01 1.36e-02 3.49e-01  -4.7 6.63e-01  -1.8 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 -3.0305991e+01 1.20e-02 2.99e-01  -4.1 7.29e+00  -2.2 1.00e+00 1.45e-01h  1
  31 -3.0393699e+01 1.19e-02 2.24e-01  -3.8 1.38e+00  -1.8 1.00e+00 7.76e-01h  1
  32 -3.0376662e+01 2.27e-03 1.05e-01  -4.1 4.45e-01  -1.4 1.00e+00 1.00e+00h  1
  33 -3.0398076e+01 7.88e-03 4.27e-01  -3.9 2.51e+00  -1.9 1.00e+00 3.89e-01h  1
  34 -3.0398327e+01 2.08e-04 5.52e-02  -4.1 2.10e-01  -1.4 1.00e+00 1.00e+00h  1
  35 -3.0416193e+01 6.20e-03 1.53e-01  -4.6 7.94e-01  -1.9 9.97e-01 1.00e+00h  1
  36 -3.0414887e+01 2.44e-04 2.69e-02  -4.8 1.69e-01  -1.5 1.00e+00 1.00e+00h  1
  37 -3.0421957e+01 2.30e-03 1.17e-01  -5.5 4.53e-01  -2.0 9.99e-01 1.00e+00h  1
  38 -3.0427253e+01 2.84e-03 2.77e-01  -5.6 9.44e-01  -2.4 1.00e+00 9.00e-01h  1
  39 -3.0426211e+01 1.53e-04 6.46e-02  -5.6 2.58e-01  -2.0 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40 -3.0426484e+01 2.90e-04 1.11e-02  -6.7 1.81e-01  -2.5 1.00e+00 1.00e+00h  1
  41 -3.0429446e+01 7.72e-02 1.75e-02  -6.1 2.78e+00    -  1.00e+00 9.93e-01h  1
  42 -3.0428624e+01 3.42e-02 2.04e-03  -6.2 1.55e+00    -  1.00e+00 1.00e+00h  1
  43 -3.0426889e+01 3.08e-05 3.86e-05  -7.3 1.71e+00    -  1.00e+00 1.00e+00h  1
  44 -3.0426888e+01 8.89e-09 6.60e-09 -11.0 8.09e-04    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 44

                                   (scaled)                 (unscaled)
Objective...............:  -3.0426888045000293e+01   -3.0426888045000293e+01
Dual infeasibility......:   6.6030411996714864e-09    6.6030411996714864e-09
Constraint violation....:   8.8854305024810287e-09    8.8854305024810287e-09
Variable bound violation:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   7.9550468675338581e-11    7.9550468675338581e-11
Overall NLP error.......:   8.8854305024810287e-09    8.8854305024810287e-09


Number of objective function evaluations             = 45
Number of objective gradient evaluations             = 45
Number of equality constraint evaluations            = 45
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 45
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 44
Total seconds in IPOPT                               = 1.428

EXIT: Optimal Solution Found.</code></pre><pre><code class="language-julia hljs">plot(sol; layout=:group, size=(800, 300))</code></pre><img src="zermelo-17bd65fb.svg" alt="Example block output"/><pre><code class="language-julia hljs">tt    = sol.times
tf    = 8
x1(t) = sol.state(t)[1]
x2(t) = sol.state(t)[2]
λ(t)  = sol.state(t)[3]
u(t) = sol.control(t)[1]</code></pre><pre><code class="language-julia hljs">plot(x1, x2, 0, tf, label=&quot;optimal trajectory&quot;, color=&quot;blue&quot;, linewidth=2)
plot!([0, 31], [0.5, 0.5], color=:black, label = false, linewidth=2)
plot!([0, 31], [3.5, 3.5], color=:black, label = false, linewidth=2)</code></pre><img src="zermelo-cea0a9ed.svg" alt="Example block output"/><pre><code class="language-julia hljs">plot(tt, u, label=&quot;optimal control&quot;, color=&quot;red&quot;, linewidth=2)
plot!(tt, λ, label=&quot;state λ&quot;, color=&quot;green&quot;, linewidth=2)</code></pre><img src="zermelo-baf7a909.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Find the first crossing time
t1_index = findfirst(t -&gt; x2(t) ≥ 0.5, tt)

# If t1 is found, find the next crossing time
if t1_index !== nothing
    t1       = tt[t1_index]
    t2_index = findfirst(t -&gt;  x2(t) ≥ 3.5, tt[t1_index+1:end])
    t2_index = t2_index !== nothing ? t2_index + t1_index : nothing
    t2 = t2_index !== nothing ? tt[t2_index] : &quot;No such t2 found&quot;
else
    t1 = &quot;No such t1 found&quot;
    t2 = &quot;No such t2 found&quot;
end
println(&quot;first crossing time: &quot;,  t1)
println(&quot;second crossing time: &quot;, t2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">first crossing time: 0.512
second crossing time: 3.6</code></pre><h1 id="Zermelo-problem,-example-2"><a class="docs-heading-anchor" href="#Zermelo-problem,-example-2">Zermelo problem, example 2</a><a id="Zermelo-problem,-example-2-1"></a><a class="docs-heading-anchor-permalink" href="#Zermelo-problem,-example-2" title="Permalink"></a></h1><p class="math-container">\[
    \left\{
    \begin{array}{l}
        \displaystyle \min - x_1(8), \\[0.5em]
        \dot{x}_1(t) = x_2(t) + \cos(u(t)), \; \text{for a.e. } t\in [0,8],\\[0.5em]
        \dot{x}_2(t) = \sin(u(t)),  \; \text{for a.e. } t\in [0,8], \\[0.5em]
        u(t) \in [-\frac{\pi}{2}, \frac{\pi}{2}], \; \text{for a.e. } t\in [0,8], \\[0.5em]
        x(0) = 0_{\mathbb{R}^2}, \quad x_2(8) = 4,\\[0.5em]
        \{x \in \mathbb{R}^2 \mid 5 &lt; x_1 &lt; 10 \} \text{ and } \{x \in \mathbb{R}^2 \mid 20 &lt; x_1 &lt; 25 \} \text{ are loss control regions.}
    \end{array}
    \right.\]</p><h2 id="Reformulation-for-the-direct-method-2"><a class="docs-heading-anchor" href="#Reformulation-for-the-direct-method-2">Reformulation for the direct method</a><a class="docs-heading-anchor-permalink" href="#Reformulation-for-the-direct-method-2" title="Permalink"></a></h2><p class="math-container">\[
    \left\{
    \begin{array}{l}
        \displaystyle \min - x_1(8) + \varepsilon \int_0^8 v^2(t)dt + \int_0^8 f_{NC}(x(t))u^2(t)dt, \\[0.5em]
        \dot{x}_1(t) = f_{C}(x(t)) (x_2(t) + \cos(u(t)))+f_{NC}(x(t)) (x_2(t) + \cos(\lambda(t))), \; \text{for a.e. } t\in [0,8],\\[0.5em]
        \dot{x}_2(t) =  f_{C}(x(t)) \sin(u(t))+f_{NC}(x(t)) \sin(\lambda(t)),  \; \text{for a.e. } t\in [0,8], \\[0.5em]
        \dot{\lambda}(t) = f_{C}(x(t))v(t),  \; \text{for a.e. } t\in [0,8], \\[0.5em]
        u(t)\in [-\frac{\pi}{2}, \frac{\pi}{2}] , \; \text{for a.e. } t\in [0,8], \\[0.5em]
        x(0) = 0_{\mathbb{R}^2}, \quad x_2(8) = 4,\\[0.5em]
        \{x \in \mathbb{R}^2 \mid 5 &lt; x_1 &lt; 10 \} \text{ and } \{x \in \mathbb{R}^2 \mid 20 &lt; x_1 &lt; 25 \} \text{ are loss control regions.}
    \end{array}
    \right.\]</p><pre><code class="language-julia hljs">I = [(5, 10), (20, 25)]
ε1 = 0.05
fNC(x) = fNC_bounded(x,I,ε1)
plot(fNC,0., 30, label=&quot;fNC&quot;)</code></pre><img src="zermelo-e833868c.svg" alt="Example block output"/><pre><code class="language-julia hljs">@def ocp1 begin

    ϵ  = 1e-3

    tf = 8

    t ∈ [ 0., tf ],                  time

    q = [ x1, x2, λ, xu, xv ] ∈ R^5, state

    ω = [u, v] ∈ R^2,                control

    #initial conditions
    x1(0) == 0
    x2(0) == 0
    xu(0) == 0
    xv(0) == 0

    #final condition
    x2(tf) == 4

    #control constraint
    -π/2  ≤  u(t)  ≤ π/2

    #state constraints
    -π/2  ≤  λ(t)  ≤ π/2

    #hybrid control system
     q̇(t) == [fNC(x1(t))*(x2(t) + cos(λ(t))) + (1-fNC(x1(t)))*(x2(t) + cos(u(t))),
             fNC(x1(t))*sin(λ(t)) + (1-fNC(x1(t)))*sin(u(t)),
             (1-fNC(x1(t)))*v(t),
             (v(t))^2,
             fNC(x1(t))*(u(t))^2]

    #cost function
    -x1(tf) + ϵ*xv(tf) + xu(tf) → min
end;</code></pre><pre><code class="language-julia hljs">N = 400
sol1 = solve(ocp1; grid_size=N);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">This is Ipopt version 3.14.16, running with linear solver MUMPS 5.7.3.

Number of nonzeros in equality constraint Jacobian...:    12805
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     3208

Total number of variables............................:     2807
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      802
                     variables with only upper bounds:        0
Total number of equality constraints.................:     2005
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  1.0000000e-04 3.90e+00 1.21e-02   0.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -2.4397078e+01 8.35e-03 2.10e+00  -5.8 2.42e+01    -  7.74e-01 1.00e+00f  1
   2 -2.4321594e+01 3.68e-03 3.85e+00  -6.5 3.30e-01   0.0 8.11e-01 1.00e+00h  1
   3 -2.4307575e+01 6.04e-04 1.51e+00  -2.3 2.34e-01  -0.5 9.77e-01 1.00e+00h  1
   4 -2.4408267e+01 1.01e-03 2.55e-02  -3.5 9.47e-02  -1.0 1.00e+00 1.00e+00h  1
   5 -2.4697024e+01 3.91e-03 2.80e-02  -4.5 2.79e-01  -1.4 1.00e+00 1.00e+00f  1
   6 -2.5472910e+01 1.38e-02 9.56e-02  -4.6 9.10e-01  -1.9 1.00e+00 1.00e+00f  1
   7 -2.5739697e+01 1.60e-02 1.65e-01  -4.4 1.72e+00  -1.5 1.00e+00 1.00e+00h  1
   8 -2.5806689e+01 2.16e-03 1.45e-01  -5.1 2.35e-01  -1.1 1.00e+00 1.00e+00h  1
   9 -2.6061241e+01 1.14e-02 1.78e-01  -5.2 8.98e-01  -1.5 1.00e+00 1.00e+00f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -2.6157129e+01 4.45e-03 3.01e-02  -5.7 3.66e-01  -1.1 1.00e+00 1.00e+00h  1
  11 -2.6446863e+01 1.25e-02 4.64e-01  -5.2 3.50e+00  -1.6 1.00e+00 5.48e-01f  1
  12 -2.6548392e+01 6.38e-03 1.31e-01  -5.5 5.71e-01  -1.2 1.00e+00 1.00e+00h  1
  13 -2.6891147e+01 1.35e-02 5.63e-01  -4.5 2.80e+00  -1.6 1.00e+00 6.75e-01f  1
  14 -2.6978545e+01 3.73e-03 1.47e-01  -5.0 3.59e-01  -1.2 1.00e+00 1.00e+00h  1
  15 -2.7275675e+01 1.56e-02 5.83e-02  -4.0 2.11e+00  -1.7 1.00e+00 9.07e-01f  1
  16 -2.7387649e+01 2.71e-03 1.20e-01  -4.4 4.12e-01  -1.3 1.00e+00 1.00e+00h  1
  17 -2.7657648e+01 1.51e-02 3.62e-02  -3.4 2.66e+00  -1.7 9.83e-01 7.20e-01f  1
  18 -2.7805791e+01 5.39e-03 1.96e-01  -3.7 6.40e-01  -1.3 9.88e-01 1.00e+00h  1
  19 -2.8004351e+01 1.15e-02 1.84e-01  -3.0 6.17e+00  -1.8 1.00e+00 3.09e-01f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 -2.8142981e+01 8.05e-03 4.02e-02  -3.2 7.25e-01  -1.4 9.83e-01 1.00e+00h  1
  21 -2.8405468e+01 1.35e-02 4.24e-01  -2.9 7.68e+00  -1.8 2.06e-01 2.45e-01f  1
  22 -2.8550933e+01 9.22e-03 3.53e-02  -3.1 8.77e-01  -1.4 9.24e-01 1.00e+00h  1
  23 -2.8830276e+01 1.43e-02 4.17e-01  -2.9 6.09e+00  -1.9 2.47e-01 3.06e-01f  1
  24 -2.9029673e+01 1.03e-02 3.68e-01  -3.0 1.43e+00  -1.5 8.58e-01 1.00e+00h  1
  25 -2.9072220e+01 1.49e-03 4.89e-02  -3.8 2.43e-01  -1.0 9.70e-01 1.00e+00h  1
  26 -2.9213737e+01 6.52e-03 4.26e-02  -4.0 7.22e-01  -1.5 9.98e-01 1.00e+00f  1
  27 -2.9259408e+01 1.39e-03 1.51e-02  -4.7 2.39e-01  -1.1 1.00e+00 1.00e+00h  1
  28 -2.9390432e+01 4.03e-03 8.96e-02  -5.2 5.36e-01  -1.6 1.00e+00 1.00e+00f  1
  29 -2.9416174e+01 1.23e-03 5.36e-02  -5.8 2.32e-01  -1.1 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 -2.9556060e+01 8.55e-03 3.25e-01  -6.4 1.47e+00  -1.6 1.00e+00 1.00e+00f  1
  31 -2.9559863e+01 1.45e-03 3.77e-02  -6.8 2.81e-01  -1.2 1.00e+00 1.00e+00h  1
  32 -2.9682016e+01 1.64e-02 4.94e-01  -7.1 2.26e+00  -1.7 1.00e+00 8.79e-01f  1
  33 -2.9670400e+01 1.63e-03 2.92e-02  -7.5 5.44e-01  -1.2 1.00e+00 1.00e+00h  1
  34 -2.9766733e+01 1.45e-02 3.46e-01  -7.2 1.48e+00  -1.7 1.00e+00 1.00e+00h  1
  35 -2.9811805e+01 1.70e-02 3.27e-01  -5.2 5.25e+00  -2.2 1.00e+00 3.14e-01h  1
  36 -2.9818106e+01 2.89e-02 2.28e-01  -4.2 5.81e+00    -  1.00e+00 3.01e-01h  1
  37 -2.9803290e+01 2.65e-03 9.89e-03 -10.2 5.11e-01    -  3.07e-01 1.00e+00h  1
  38 -2.9791620e+01 9.40e-04 4.80e-02  -4.8 1.33e+00    -  8.30e-01 1.00e+00H  1
  39 -2.9792706e+01 2.57e-03 1.34e-02  -5.2 5.18e-01    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40 -2.9792333e+01 5.81e-05 1.54e-04  -6.6 7.03e-02    -  1.00e+00 1.00e+00h  1
  41 -2.9792304e+01 2.77e-06 8.83e-06  -8.7 1.67e-02    -  1.00e+00 1.00e+00h  1
  42 -2.9792304e+01 5.85e-11 5.51e-11 -11.0 7.57e-05    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 42

                                   (scaled)                 (unscaled)
Objective...............:  -2.9792303771910330e+01   -2.9792303771910330e+01
Dual infeasibility......:   5.5118792268284231e-11    5.5118792268284231e-11
Constraint violation....:   5.8486437914950784e-11    5.8486437914950784e-11
Variable bound violation:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   2.0573569436357918e-11    2.0573569436357918e-11
Overall NLP error.......:   5.8486437914950784e-11    5.8486437914950784e-11


Number of objective function evaluations             = 44
Number of objective gradient evaluations             = 43
Number of equality constraint evaluations            = 44
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 43
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 42
Total seconds in IPOPT                               = 1.311

EXIT: Optimal Solution Found.</code></pre><pre><code class="language-julia hljs">plot(sol; layout=:group, size=(800, 300))</code></pre><img src="zermelo-df24c7ae.svg" alt="Example block output"/><pre><code class="language-julia hljs">tt    = sol1.times
tf    = 8
x1(t) = sol1.state(t)[1]
x2(t) = sol1.state(t)[2]
λ(t)  = sol1.state(t)[3]
u(t)  = sol1.control(t)[1];</code></pre><pre><code class="language-julia hljs"># Plot the optimal trajectory
plot(x1, x2, 0, tf, label=&quot;optimal trajectory&quot;, color=&quot;blue&quot;, linewidth=2)
plot!([5, 5], [0, 5], color=:black, label=false, linewidth=2)
plot!([10, 10],  [0, 5], color=:black, label=false, linewidth=2)
plot!([20, 20],  [0, 5], color=:black, label=false, linewidth=2)
plot!([25, 25],  [0, 5], color=:black, label=false, linewidth=2)</code></pre><img src="zermelo-69fccb19.svg" alt="Example block output"/><pre><code class="language-julia hljs">plot(tt, u, label=&quot;optimal control&quot;, color=&quot;red&quot;, linewidth=2)
plot!(tt, λ, label=&quot;state λ&quot;, color=&quot;green&quot;, linewidth=2)</code></pre><img src="zermelo-628c12ca.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Find the crossing times based on conditions for x1
t1_index = findfirst(t -&gt; x1(t) &gt; 5, tt)
t2_index = nothing
t3_index = nothing
t4_index = nothing

# If t1 is found, find the next crossing times
if t1_index !== nothing
    t2_index = findfirst(t -&gt; x1(t) &gt; 10, tt[t1_index+1:end])
    t2_index = t2_index !== nothing ? t2_index + t1_index : nothing
end

if t2_index !== nothing
    t3_index = findfirst(t -&gt; x1(t) &gt; 20, tt[t2_index+1:end])
    t3_index = t3_index !== nothing ? t3_index + t2_index : nothing
end

if t3_index !== nothing
    t4_index = findfirst(t -&gt; x1(t) &gt; 25, tt[t3_index+1:end])
    t4_index = t4_index !== nothing ? t4_index + t3_index : nothing
end

# Convert indices to times
t11 = t1_index !== nothing ? tt[t1_index] : &quot;No such t1 found&quot;
t22 = t2_index !== nothing ? tt[t2_index] : &quot;No such t2 found&quot;
t33 = t3_index !== nothing ? tt[t3_index] : &quot;No such t3 found&quot;
t44 = t4_index !== nothing ? tt[t4_index] : &quot;No such t4 found&quot;

println(&quot;First crossing time: &quot;, t11)
println(&quot;Second crossing time: &quot;, t22)
println(&quot;Third crossing time: &quot;, t33)
println(&quot;Fourth crossing time: &quot;, t44)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">First crossing time: 2.98
Second crossing time: 4.24
Third crossing time: 6.12
Fourth crossing time: 6.98</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="numerical.html">« Numerical approach</a><a class="docs-footer-nextpage" href="ho.html">Harmonic oscillator problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Thursday 22 August 2024 11:33">Thursday 22 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
